const addItemForm=document.querySelector("#to-do-add"),addItemFormField=document.querySelector("#to-do-add-input"),toDoList=document.querySelector("#to-do-list");function taskState(t,e){e?t.classList.add("_completed"):t.classList.remove("_completed")}function renderTask(t){const e=document.createElement("li"),a=document.createElement("label"),s=document.createElement("input"),o=document.createElement("span"),d=document.createElement("div"),c=document.createElement("p"),r=document.createElement("button");return e.classList.add("to-do-item"),a.classList.add("checkbox","to-do-item__complete"),s.classList.add("checkbox__input"),o.classList.add("checkbox__circle"),d.classList.add("to-do-item__textbox"),c.classList.add("to-do-item__text"),r.classList.add("to-do-item__remove"),s.type="checkbox",r.type="button",e.dataset.taskId=t.id,e.dataset.taskElement=!0,c.textContent=t.text,c.dataset.taskText=!0,a.dataset.taskCheckbox=!0,s.checked=t.completed,r.dataset.taskRemove=!0,taskState(c,t.completed),a.append(s,o),d.append(c),e.append(a,d,r),e}function createTask(t,e=!1){return{id:(new Date).getTime(),text:t,completed:e}}function getTasksFromStorage(){var t=localStorage.getItem("tasks");if(t){t=JSON.parse(t);if(null!==t)return t.items||[]}return[]}function setTasksToStorage(t){localStorage.setItem("tasks",JSON.stringify(t))}function expandTasksStorage(t){setTasksToStorage({items:[...getTasksFromStorage(),t]})}function reduceTasksStorage(e){const t=getTasksFromStorage();setTasksToStorage({items:t.filter(t=>t.id!==+e)})}function updateTaskInStorage(a,s){const t=getTasksFromStorage(),o=[];t.forEach(t=>{var e;t.id===+a?(e={...t,...s},o.push(e)):o.push(t)}),setTasksToStorage({items:o})}getTasksFromStorage().forEach(t=>{toDoList.append(renderTask(t))}),toDoList.addEventListener("click",t=>{const e=t.target.closest("[data-task-id]");t.target.closest("[data-task-remove]")&&(e.remove(),reduceTasksStorage(e.dataset.taskId))}),toDoList.addEventListener("input",t=>{const e=t.target.closest("[data-task-id]"),a=t.target.closest("[data-task-checkbox]");t=a.querySelector("input").checked;a&&(taskState(e.querySelector("[data-task-text]"),t),updateTaskInStorage(e.dataset.taskId,{completed:t}))}),addItemForm.addEventListener("submit",t=>{t.preventDefault();t=addItemFormField.value.trim();t&&(t=createTask(t),toDoList.append(renderTask(t)),expandTasksStorage(t),addItemFormField.value="")});